import os
#import ember
#import numpy as np
#import pandas as pd
import csv 
'''
data_dir = "../../ember_dataset/"

#emberdf = ember.create_metadata(data_dir)
emberdf = ember.read_metadata(data_dir)
#X_train, y_train, X_test, y_test = ember.create_vectorized_features(data_dir)
X_train, y_train, X_test, y_test = ember.read_vectorized_features(data_dir)

X = np.concatenate((X_train, X_test))
y = np.concatenate((y_train, y_test))
df = pd.concat([emberdf, pd.DataFrame(X)], axis=1)

mal_sha256 = df[df.label == 1].sha256
#with open('mal_sha256.txt','a') as writefile:
#    writefile.write(mal_sha256)
mal_sha256.to_csv("mal_sha256.csv")

#print(mal_sha256)

for row in mal_sha256:
    print(row)
    #cmd = "wget --user infected --password infected http://www.virusign.com/file/%s.7z" % (row)
    cmd = "python3 vxapi.py get_result --environmentId 100 %s --type bin" % (row)

    os.system(cmd)
'''
start_downloading = False
with open("mal_sha256.csv", "r") as infile:
    reader = csv.reader(infile, delimiter=',')

    for row in reader:
        if row[1] == "9426cf64297b2974c8e985e959c0a4815231efa34e057fea860c5c39f84009b0":
            start_downloading = True
        if start_downloading:
            print(row[1])
            cmd = "python3 vxapi.py get_result --environmentId 100 %s --type bin" % (row[1])
            os.system(cmd)
